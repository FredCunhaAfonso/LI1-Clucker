<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa3_2022li1g124</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Frederico Cunha Afonso &lt;a104001@alunos.uminho.pt&gt;<br />Diogo Teixeira Fernandes &lt;a104260@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa3_2022li1g124</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 3 do projeto de LI1 em 2022/23.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:animaJogo">animaJogo</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></li><li class="src short"><a href="#v:animaobs">animaobs</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; Int -&gt; <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</li><li class="src short"><a href="#v:corrente">corrente</a> :: <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a></li><li class="src short"><a href="#v:limites">limites</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; <a href="LI12223.html#t:Direcao" title="LI12223">Direcao</a> -&gt; <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; <a href="LI12223.html#t:Largura" title="LI12223">Largura</a> -&gt; <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:animaJogo" class="def">animaJogo</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> -&gt; <a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a> -&gt; <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a> <a href="#v:animaJogo" class="selflink">#</a></p><div class="doc"><h2>animaJogo</h2><p>A fun&#231;&#227;o &quot;<strong><code><a href="Tarefa3_2022li1g124.html#v:animaJogo" title="Tarefa3_2022li1g124">animaJogo</a></code></strong>&quot; &#233; uma fun&#231;&#227;o que, dado um <code><a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></code> e uma <code><a href="LI12223.html#t:Jogada" title="LI12223">Jogada</a></code>
permite alterar as <code><a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a></code> do <code><a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a></code> e os <code><a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a></code>s presentes 
no <code><a href="LI12223.html#t:Mapa" title="LI12223">Mapa</a></code></p><h3>Defini&#231;&#227;o dada</h3><pre>animaJogo :: Jogo -&gt; Jogada -&gt; Jogo
animaJogo (Jogo (Jogador (x,y)) (Mapa larg terObs)) (Parado)
    | (snd(terObs !! y)) !! x == Tronco = Jogo (Jogador (x + vel,y)) (Mapa larg (animaobs terObs 0 (x,y)))
    | otherwise                         = Jogo (Jogador (x,y)) (Mapa larg (animaobs terObs 0 (x,y)))
        where vel = velTer1(fst (terObs !! y))
animaJogo (Jogo (Jogador (x,y)) (Mapa larg terObs)) (Move dir)
    = (Jogo (Jogador (corrente (limites terObs dir (x,y) larg) terObs)) (Mapa larg (animaobs terObs 0 (limites terObs dir (x,y) larg))))
</pre></div></div><div class="top"><p class="src"><a id="v:animaobs" class="def">animaobs</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; Int -&gt; <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] <a href="#v:animaobs" class="selflink">#</a></p><div class="doc"><h2>animaobs</h2><p>A fun&#231;&#227;o &quot;<strong><code><a href="Tarefa3_2022li1g124.html#v:animaobs" title="Tarefa3_2022li1g124">animaobs</a></code></strong>&quot; &#233; uma fun&#231;&#227;o que, desloca os <code><a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a></code>s numa certa 
dire&#231;&#227;o dependendo da <code><a href="LI12223.html#t:Velocidade" title="LI12223">Velocidade</a></code> do <code><a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a></code></p><h3>Defini&#231;&#227;o dada</h3><pre>animaobs :: [(Terreno, [Obstaculo])] -&gt; Int -&gt; Coordenadas -&gt; [(Terreno, [Obstaculo])]
animaobs [] _ _= []
animaobs ((Relva, obs):t) _ (x,y) = ((Relva, obs):(animaobs t 0 (x,(y-1))))
animaobs (((Estrada vel),obs):t) k (x,y) 
    | k == vel || (((y == 0) &amp;&amp; (obs !! x == Carro))) = ((Estrada vel), obs):(animaobs t 0 (x,(y-1)))
    | vel &lt; 0                                         = animaobs (((Estrada vel),((tail obs) ++ [head obs])):t) (k-1) (x,y)
    | vel &gt; 0                                         = animaobs (((Estrada vel),((last obs):(init obs))):t) (k+1) (x,y)
animaobs (((Rio vel),obs):t) k (x,y) 
    | k == vel = ((Rio vel), obs):(animaobs t 0 (x,(y-1)))
    | vel &lt; 0  = animaobs (((Rio vel),((tail obs) ++ [head obs])):t) (k-1) (x,y)
    | vel &gt; 0  = animaobs (((Rio vel),((last obs):(init obs))):t) (k+1) (x,y)
</pre></div></div><div class="top"><p class="src"><a id="v:corrente" class="def">corrente</a> :: <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> <a href="#v:corrente" class="selflink">#</a></p><div class="doc"><h2>corrente</h2><p>A fun&#231;&#227;o &quot;<strong><code><a href="Tarefa3_2022li1g124.html#v:corrente" title="Tarefa3_2022li1g124">corrente</a></code></strong>&quot; &#233; uma fun&#231;&#227;o que, verifica se o <code><a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a></code> 
se encontra num 'Tronco ou n&#227;o</p><h3>Defini&#231;&#227;o dada</h3><pre>corrente :: Coordenadas -&gt; [(Terreno, [Obstaculo])] -&gt; Coordenadas
corrente (x,y) terobs | (snd (terobs !! y))!!x == Tronco = (x+(velTer1 (fst(terobs !! y))),y)
                      | otherwise                        = (x,y)  
</pre></div></div><div class="top"><p class="src"><a id="v:limites" class="def">limites</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; <a href="LI12223.html#t:Direcao" title="LI12223">Direcao</a> -&gt; <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> -&gt; <a href="LI12223.html#t:Largura" title="LI12223">Largura</a> -&gt; <a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a> <a href="#v:limites" class="selflink">#</a></p><div class="doc"><h2>limites</h2><p>A fun&#231;&#227;o &quot;<strong><code><a href="Tarefa3_2022li1g124.html#v:limites" title="Tarefa3_2022li1g124">limites</a></code></strong>&quot; &#233; uma fun&#231;&#227;o que, recebendo uma 
lista de tuplos <code><a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a></code>s | lista de <code><a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a></code>s, 
<code><a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a></code> e <code><a href="LI12223.html#t:Largura" title="LI12223">Largura</a></code>, devolve novas <code><a href="LI12223.html#t:Coordenadas" title="LI12223">Coordenadas</a></code>, 
vendo se o <code><a href="LI12223.html#t:Jogador" title="LI12223">Jogador</a></code> pode ou n&#227;o efetuar uma dada uma <code><a href="LI12223.html#t:Direcao" title="LI12223">Direcao</a></code> 
Podemos assim definir &quot;<strong><code><a href="Tarefa3_2022li1g124.html#v:limites" title="Tarefa3_2022li1g124">limites</a></code></strong>&quot; da seguinte maneira:</p><h3>Defini&#231;&#227;o dada</h3><pre>limites :: [(Terreno, [Obstaculo])] -&gt; Direcao -&gt; Coordenadas -&gt; Largura -&gt; Coordenadas
limites terObs Cima (x, y) larg
    | y == 0 || snd (terObs !! (y-1)) !! x == Arvore = (x,y) 
    | otherwise                                      = (x,y-1)
limites terObs Baixo (x, y) larg
    | (y +1) == length terObs || snd (terObs !! (y+1)) !! x == Arvore = (x,y) 
    | otherwise                                                       = (x,y+1)
limites terObs Esquerda (x, y) larg
    | x == 0 || snd (terObs !! y) !! (x-1) == Arvore = (x,y)
    | otherwise                                      = (x-1,y)
        where vel = velTer1(fst (terObs !! y))
limites terObs Direita (x, y) larg
    | (x+1) == larg || snd (terObs !! y) !! (x+1) == Arvore = (x,y)
    | otherwise                                             = (x+1,y)
        where vel = velTer1(fst (terObs !! y))   
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>